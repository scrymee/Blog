---
categories:
  - programming
tags:
  - [sql]
  - [cache]
date: 2022-09-14 10:16:58
title: キャッシュの役割に関しての知見
---

<!-- toc -->

<!-- more -->

## キャッシュについての知見を得る動機

MYSQLのバージョンアップ時に、急激に負荷が高まるケースが有った。詳しく調査するとMySQL8にて**クエリキャッシュが廃止されるため負荷が高まる**ため発生するということだった。

そもそもキャッシュの意義について明確に理解していなかったのだが、今回のケースで明確になったので一旦事例を整理しておく。

## キャッシュは高速化だけでな負荷軽減の役割がある


もともとクエリキャッシュはMYSQLのSELECT文などの結果をMYSQL内にキャッシュとして保存しておくことで呼び出し時の負荷を軽減することを目的としていたようだ。

ただ、MYSQL8.0で廃止され、代わりにRedisなどの外部キャッシュを利用するように推奨されている。

実際クエリキャッシュがなくなることで、CPU負荷がかかり速度が明確に落ちたようだ。

いままでこういうのを意識するほどのケースに遭遇しなかったが、キャッシュには**高速化**の他に負荷軽減の役割があったようだ

## そもそもクエリキャッシュはMysql8で廃止される

まあなくなるので詳細は割愛


## キャッシュをぶん回す

「SELECTでデータを抽出しているロジックすべてにキャッシュを入れようか」という案が検討される程度には規模が大きくなるにつれてキャッシュの意義は増していく。それくらい気持ち極端なマインドでいても良い気がする