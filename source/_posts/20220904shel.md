---
categories:
  - programming
tags:
  - shell
date: 2022-09-04 20:20:09
title: シェルスクリプトでの$1や$2などはデリミタによって認識される
---

<!-- toc -->

<!-- more -->

## shellの引数はデリミタによって取得される

test.shとしてこういうのをつくる

```sh
#!/bin/sh

echo '$1の結果'
echo $1
echo "--------"

echo '$2の結果'
echo $2
echo "--------"

```
ちなみにechoの次の文字をダブルクオーテーションにすると$1や$2などの変数が展開されてしまうため、文字として出力したい場合はシングルクォーテーションを使う

```sh
echo 'りんご みかん' | xargs sh test.sh
$1の結果
りんご
--------
$2の結果
みかん
--------
```

### xargsにn1オプションを付けた場合
```sh
echo 'りんご みかん' | xargs -n1 sh test.sh
$1の結果
りんご
--------
$2の結果

--------
$1の結果
みかん
--------
$2の結果

--------
```
$2が取得できない（引数を1つずつ渡すため）


シェルスクリプト内で用いられる$1や$2は`sh test.sh`の引数なので納得できる
では改行のケースはどうだろうか

## 改行を含むファイルに対しての特殊文字について


test.txtとして、こういうものをつくる
半角スペースと改行があるもの

```txt
りんご みかん
バナナ

```

また、test.shに第三引数を取得するような処理を追加する

```sh
#!/bin/sh

echo '$1の結果'
echo $1
echo "--------"

echo '$2の結果'
echo $2
echo "--------"

echo '$3の結果'
echo $3
echo "--------"
```

実行

```sh
cat test.txt | xargs sh test.sh 
$1の結果
りんご
--------
$2の結果
みかん
--------
$3の結果
バナナ
--------
```

改行も引数として利用された！！

そのため引数を2ずつと明示的に宣言してあげると2個ずつになる

```sh
cat test.txt | xargs -n2 sh test.sh 
$1の結果
りんご
--------
$2の結果
みかん
--------
$3の結果

--------
$1の結果
バナナ
--------
$2の結果

--------
$3の結果

--------

```
つまり、引数として認識されるのは改行も半角スペースも同じなのだ

## 半角スペースや改行はデフォルトのデリミタとして指定されている

> bashの場合「スペース」「タブ」「改行」（$' \t\n'）といった値が初期設定されていて、これらが文字の区切りとして認識されています。

[【シェルスクリプト】IFSで区切り文字（デリミタ）を変更する方法 | server-memo.net](https://www.server-memo.net/shellscript/ifs.html)


## awkを用いた特殊パラメータについて

test.txtを再度使用する

```txt
りんご みかん
バナナ

```

test.txtをawkで実行してみる

余談だがawkの中身をダブルクオーテーションにしたらすべてが出力された。理由は謎だがシングルクォーテーションを使おう

```sh
# 1つ目の引数を取得する
cat test.txt | awk '{print $1}'
りんご
バナナ

# 2つ目の引数を取得する=> 行単位で実行
cat test.txt | awk '{print $2}'
みかん
#空文字

# 3つ目の引数を取得する=> 行単位で実行
cat test.txt | awk '{print $3}'
#空文字
#空文字

```

awkで使われる特殊引数は、改行と半角スペースは明確に区別されているようだ

おそらく、**標準入力として受け取るか、引数として受け取るか**の違いだろうな。
`cat test.txt | xargs sh test.sh `の例だと引数として受け取っているので、これはxargsによって引数設定を行うことで、半角スペースとか改行の区別がなくなったのだろう



またechoを用いた場合も次のようになる

```sh
'りんご みかん' | awk '{print $1}'
りんご

'りんご みかん' | awk '{print $2}'
みかん

echo 'りんご みかん' | awk '{print $0}'
りんご みかん

echo 'りんご みかん' | awk '{print $3}'
# 空文字

```

標準入力の場合は改行と半角スペースは区別されるようだ。
同じ役割っぽいのに挙動が微妙に違うのは少し厄介だなあ