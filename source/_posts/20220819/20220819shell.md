---
categories:
  - programming
tags:
  - shell
date: 2022-08-19 00:20:35
title: shellのオプションのユースケース紹介
---


<!-- toc -->

<!-- more -->

## シェルのオプションのユースケース紹介

シェルのオプションのユースケースを検討時点で紹介していく

## デバッグ機能をつけたい

シェルスクリプトで変数に値を渡してそのコマンドを実行する処理を書いた。
その結果どのようなコマンドが実行されたかを確認したい

`-x`オプションを使うと良い。

`sh -x XXX.sh`

また、シェルファイルに書く場合は

```sh
#!/bin/bash -x
```

と書いても良いらしいし、特定のロジックのみ確認したい場合は`set -x`と`set +x`で囲む
なぜかシバン内に書いても動作しなかったので、基本的にはsetを使う

```sh
#!/bin/bash
set -x
echo 'TEST'
set +x
```

## shellで実行中にエラーが出たら処理を停止する

これはあえて付けるというより、なぜかシェルスクリプトが最後まで実行されないケースがあったときに調査するとこのオプションが付いていたからだったという経験に基づく

`-e`オプションで、処理がエラーで返却された時点で後続の処理を実行させない

`sh -e XXX.sh`

ちなみに直前の終了ステータスは`$?`で確認できる

下記のようにhogeディレクトリに移動して、fugaファイルを作りたいスクリプトのときに、使うだろう。ちなみに僕の場合はphpunitの実行が途中で終わってしまうのが不明で困っていたら、シェルの実行にこのオプションが付与されたいたためだったという経験がある。

```sh

cd hoge

mkdir fuga


```

もしeオプションを付与せずに実行した場合。hogeファイルが無いという処理は進むが、現在のディレクトリにfugaファイルを作成してしまう。
つまり、`./fuga`が作成される。

`./hoge/fuga`を作る場合は、きちんと`eオプション`をつける


## 参考文献

[シェルスクリプトの罠を避ける三つの tips - Qiita](https://qiita.com/magicant/items/f3554274ee500bddaca8)